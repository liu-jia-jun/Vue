<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>promise的基本使用</title>
</head>

<body>
    <img src="../imgs/promise的运行流程.png">

    <script>
        /*
   promise 是 JS 中进行异步编程的新的解决方案
            (1) 从语法上说: promise 是一个构造函数
            (2) 从功能上说: promise 对象用来封装一个异步操作并可以获取结果

        promise 支持链式调用，可以解决回调地狱问题
            回调地狱: 回调函嵌套调用，外部回调函数异步执行的结果是嵌套的回调执行的条件
                回调地狱有不便于阅读，不便于异常处理等缺点
            
            解决: promise 链式调用




        1.pending变成resolved
        2.pending变成rejected

        说明: 只有这两种，且有一个promise对象只能改变一次
                无论变成成功还是失败都会有一个结果数据
                成功的结果数据一般称为Value，失败的结果数据一般称为reason

        
      
        
        */

        //1.创建一个新的promise对象

        const p = new Promise((resolve, reject) => {// 执行器函数

            // 2. 执行异步操作任务
            setTimeout(() => {
                const time = Date.now()

                if (time % 2 == 0) {
                    resolve("成功的数据，time=" + time)
                } else {
                    reject("失败的数据，time=" + time)
                }
            }, 1000)

        })

        p.then(
            value => { // 接收到成功的 value 数据    onresolved
                console.log("成功的回调", value)
            },
            reason => { // 接收到失败的 reason 数据    onresolved 
                console.log("失败的回调", reason)
            }
        )


    </script>
</body>

</html>